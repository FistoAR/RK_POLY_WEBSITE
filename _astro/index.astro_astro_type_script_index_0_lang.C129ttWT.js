const e={searchInput:document.getElementById("search-input"),clearSearch:document.getElementById("clear-search"),categoryRadios:document.querySelectorAll(".category-filter"),sortSelect:document.getElementById("sort"),viewGridBtn:document.getElementById("view-grid"),viewListBtn:document.getElementById("view-list"),productGrid:document.getElementById("product-grid"),productList:document.getElementById("product-list"),filtersSidebar:document.getElementById("filters-sidebar"),mobileOverlay:document.getElementById("mobile-filter-overlay"),toggleFiltersMobile:document.getElementById("toggle-filters-mobile"),toggleFiltersDesktop:document.getElementById("toggle-filters-desktop"),closeFilters:document.getElementById("close-filters"),applyFiltersMobile:document.getElementById("apply-filters-mobile"),filterToggleText:document.getElementById("filter-toggle-text"),filterSectionToggles:document.querySelectorAll(".filter-section-toggle"),clearAllFilters:document.getElementById("clear-all-filters"),resetFiltersBtn:document.getElementById("reset-filters-btn"),activeFiltersContainer:document.getElementById("active-filters-container"),activeFiltersBadge:document.getElementById("active-filters-badge"),productCards:document.querySelectorAll(".product-card"),productCardsLis:document.querySelectorAll(".product-card-list"),categorySections:document.querySelectorAll(".category-section"),categorySectionsLis:document.querySelectorAll(".category-section-list"),productCount:document.getElementById("product-count"),emptyState:document.getElementById("empty-state")};let s={search:"",category:"all",sort:"default"},h=!0,d="grid",y=null;function m(){console.log("Initializing filters..."),E(),w(),n(),console.log("Filters initialized successfully")}function E(){const t=new URLSearchParams(window.location.search);if(t.has("q")&&(s.search=t.get("q")||"",e.searchInput&&(e.searchInput.value=s.search),s.search&&e.clearSearch&&e.clearSearch.classList.remove("hidden")),t.has("category")){const a=t.get("category")||"all";s.category=a,e.categoryRadios.forEach(i=>{i.checked=i.dataset.id===a})}t.has("sort")&&(s.sort=t.get("sort")||"default",e.sortSelect&&(e.sortSelect.value=s.sort)),t.has("view")&&(d=t.get("view")||"grid",b())}function o(){const t=new URLSearchParams;s.search&&t.set("q",s.search),s.category!=="all"&&t.set("category",s.category),s.sort!=="default"&&t.set("sort",s.sort),d!=="grid"&&t.set("view",d);const a=t.toString()?`${window.location.pathname}?${t.toString()}`:window.location.pathname;window.history.replaceState({},"",a)}function w(){e.searchInput?.addEventListener("input",B),e.clearSearch?.addEventListener("click",S),e.categoryRadios.forEach(t=>{t.addEventListener("change",F)}),e.sortSelect?.addEventListener("change",I),e.viewGridBtn?.addEventListener("click",()=>p("grid")),e.viewListBtn?.addEventListener("click",()=>p("list")),e.toggleFiltersMobile?.addEventListener("click",x),e.toggleFiltersDesktop?.addEventListener("click",k),e.closeFilters?.addEventListener("click",u),e.mobileOverlay?.addEventListener("click",u),e.applyFiltersMobile?.addEventListener("click",u),e.filterSectionToggles.forEach(t=>{t.addEventListener("click",A)}),e.clearAllFilters?.addEventListener("click",t=>{t.preventDefault(),L()}),e.resetFiltersBtn?.addEventListener("click",t=>{t.preventDefault(),L()}),document.addEventListener("keydown",M)}function C(t,a){return function(...r){y&&clearTimeout(y),y=setTimeout(()=>t(...r),a)}}function B(t){const a=t.target;s.search=a.value.trim(),s.search?e.clearSearch?.classList.remove("hidden"):e.clearSearch?.classList.add("hidden"),C(()=>{n(),o()},300)()}function S(){e.searchInput&&(e.searchInput.value=""),s.search="",e.clearSearch?.classList.add("hidden"),n(),o(),g()}function F(t){const i=t.target.dataset.id||"all";s.category=i,console.log("Category changed to:",i),n(),o(),g()}function I(t){const a=t.target;s.sort=a.value,n(),o()}function p(t){d=t,b(),o()}function b(){d==="grid"?(e.productGrid?.classList.remove("hidden"),e.productList?.classList.add("hidden"),e.viewGridBtn?.classList.add("bg-gray-100","text-gray-900"),e.viewGridBtn?.classList.remove("text-gray-400"),e.viewListBtn?.classList.remove("bg-gray-100","text-gray-900"),e.viewListBtn?.classList.add("text-gray-400")):(e.productGrid?.classList.add("hidden"),e.productList?.classList.remove("hidden"),e.viewListBtn?.classList.add("bg-gray-100","text-gray-900"),e.viewListBtn?.classList.remove("text-gray-400"),e.viewGridBtn?.classList.remove("bg-gray-100","text-gray-900"),e.viewGridBtn?.classList.add("text-gray-400"))}function x(){e.filtersSidebar?.classList.remove("-translate-x-full"),e.mobileOverlay?.classList.remove("hidden"),document.body.style.overflow="hidden"}function u(){e.filtersSidebar?.classList.add("-translate-x-full"),e.mobileOverlay?.classList.add("hidden"),document.body.style.overflow=""}function k(){h=!h,h?(e.filtersSidebar?.classList.remove("lg:hidden"),e.filterToggleText&&(e.filterToggleText.textContent="Hide Filters")):(e.filtersSidebar?.classList.add("lg:hidden"),e.filterToggleText&&(e.filterToggleText.textContent="Show Filters"))}function A(t){const a=t.currentTarget,i=a.dataset.section,r=document.getElementById(`${i}-content`),l=a.querySelector(".filter-chevron");r&&(r.classList.toggle("hidden"),l?.classList.toggle("rotate-180"))}function n(){const t=s.search.toLowerCase();let a=0;e.categorySections.forEach(r=>{const l=r.dataset.categoryId;s.category==="all"||s.category===l?r.classList.remove("hidden"):r.classList.add("hidden")}),e.categorySectionsLis.forEach(r=>{const l=r.dataset.categoryId;s.category==="all"||s.category===l?r.classList.remove("hidden"):r.classList.add("hidden")}),[...e.productCards,...e.productCardsLis].forEach(r=>{const l=r.dataset.category||"",c=r.dataset.name||"";let f=!0;s.category!=="all"&&l!==s.category&&(f=!1),t&&f&&(c.includes(t)||(f=!1)),f?(r.classList.remove("hidden"),r.classList.contains("product-card")&&a++):r.classList.add("hidden")}),e.categorySections.forEach(r=>{r.querySelectorAll(".product-card:not(.hidden)").length===0&&r.classList.add("hidden")}),e.categorySectionsLis.forEach(r=>{r.querySelectorAll(".product-card-list:not(.hidden)").length===0&&r.classList.add("hidden")}),T(),q(a),R(a),g()}function T(){const t=s.sort;t!=="default"&&(e.categorySections.forEach(a=>{const i=a.querySelector(".grid");if(!i)return;const r=Array.from(i.querySelectorAll(".product-card:not(.hidden)"));v(r,t).forEach(c=>i.appendChild(c))}),e.categorySectionsLis.forEach(a=>{const i=a.querySelector(".space-y-3");if(!i)return;const r=Array.from(i.querySelectorAll(".product-card-list:not(.hidden)"));v(r,t).forEach(c=>i.appendChild(c))}))}function v(t,a){return[...t].sort((i,r)=>{const l=i.dataset.name||"",c=r.dataset.name||"";switch(a){case"name-asc":return l.localeCompare(c);case"name-desc":return c.localeCompare(l);default:return 0}})}function q(t){e.productCount&&(e.productCount.textContent=`${t} product${t!==1?"s":""}`)}function R(t){e.emptyState&&(t===0?(e.emptyState.classList.remove("hidden"),e.productGrid?.classList.add("hidden"),e.productList?.classList.add("hidden")):(e.emptyState.classList.add("hidden"),d==="grid"?e.productGrid?.classList.remove("hidden"):e.productList?.classList.remove("hidden")))}function g(){const t=[];if(s.search&&t.push({label:"Search",value:`"${s.search}"`,type:"search"}),s.category!=="all"){const i=document.querySelector(`label[for="cat-${s.category}"]`)?.textContent?.split("(")[0].trim()||s.category;t.push({label:"Type",value:i,type:"category"})}e.activeFiltersBadge&&(t.length>0?(e.activeFiltersBadge.textContent=t.length.toString(),e.activeFiltersBadge.classList.remove("hidden")):e.activeFiltersBadge.classList.add("hidden")),e.clearAllFilters&&(t.length>0?e.clearAllFilters.classList.remove("hidden"):e.clearAllFilters.classList.add("hidden")),e.activeFiltersContainer&&(t.length>0?(e.activeFiltersContainer.classList.remove("hidden"),e.activeFiltersContainer.innerHTML=t.map(a=>`
          <span class="inline-flex items-center gap-1 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full text-sm border border-blue-200">
            <span class="text-blue-500 font-medium">${a.label}:</span> ${a.value}
            <button class="remove-filter ml-1 text-blue-400 hover:text-blue-600 transition-colors" data-type="${a.type}" type="button">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
              </svg>
            </button>
          </span>
        `).join(""),e.activeFiltersContainer.querySelectorAll(".remove-filter").forEach(a=>{a.addEventListener("click",G)})):(e.activeFiltersContainer.classList.add("hidden"),e.activeFiltersContainer.innerHTML=""))}function G(t){t.preventDefault(),t.stopPropagation();const i=t.currentTarget.dataset.type||"";if(i==="search")S();else if(i==="category"){s.category="all";const r=document.querySelector('input[data-id="all"]');r&&(r.checked=!0),n(),o(),g()}}function L(){console.log("Resetting all filters..."),s={search:"",category:"all",sort:"default"},e.searchInput&&(e.searchInput.value=""),e.clearSearch?.classList.add("hidden"),e.categoryRadios.forEach(t=>{t.checked=t.dataset.id==="all"}),e.sortSelect&&(e.sortSelect.value="default"),n(),o(),g(),u(),console.log("Filters reset complete")}function M(t){t.key==="Escape"&&e.filtersSidebar&&!e.filtersSidebar.classList.contains("-translate-x-full")&&u(),(t.ctrlKey||t.metaKey)&&t.key==="k"&&(t.preventDefault(),e.searchInput?.focus())}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m();
